/*
 * Copyright (C) 2009-2021 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/ui/base/Object","sap/ui/unified/DateTypeRange","hcm/fab/myleaverequest/utils/formatters","hcm/fab/lib/common/util/DateUtil"],function(u,D,F,a){"use strict";var C=u.extend("hcm.fab.myleaverequest.utils.CalendarUtil",{});C.configureCalendar=function(c,o,r){if(!c){return;}if(sap.ui.unified.CalendarDayType.NonWorking){c.setNonWorkingDays([]);}if(o){o.metadataLoaded().then(function(){o.getMetaModel().loaded().then(function(){var p=o.getMetaModel().getProperty("/dataServices/schema/0/entityType/[${name} === 'EmployeeCalendar']/property/[${name} === 'IsPublicHoliday']");var s=p&&p.type==="Edm.Boolean";if(!s){var l=sap.ui.getCore().byId(c.getLegend());l.removeItem(l.getId().replace("-legend","-pubHolidayCalLegend"));}});});}this._oResourceBundle=r;};C.fillCalendarWithLeaves=function(c,l,s,e){if(s){s=a.convertToUTC(s);}if(e){e=a.convertToUTC(e);}var S=[],b=[],i=false,m=l.filter(function(L,d,g){S=g.map(function(o){return o.StartDate.getTime();});S.splice(d,1);i=S.indexOf(L.StartDate.getTime())!==-1;if(!i){b.push(l[d]);}return i;});var f=function(L,c,t,T){L.forEach(function(o){if(s&&o.EndDate<s){return;}if(e&&o.StartDate>e){return;}var d=(s&&o.StartDate<s)?s:o.StartDate,g=(e&&o.EndDate>e)?e:o.EndDate,h=o.__metadata.id.substring(o.__metadata.id.lastIndexOf("/")+1),j=new D({startDate:a.convertToLocal(d),endDate:a.convertToLocal(g),type:T?T:F.getCalendarTypeFromStatus(o.StatusID),tooltip:t?t:o.AbsenceTypeName,customData:{key:"path",value:h}});c.addSpecialDate(j);});};f(b,c);f(m,c,this._oResourceBundle.getText("multiLeaveTxt"),sap.ui.unified.CalendarDayType.Type10);};C.fillCalendarFromEmployeeCalendar=function(c,s){var p=s.filter(function(S){return S.IsPublicHoliday||S.IsPublicHoliday==="TRUE";});var n=s.filter(function(S){return!S.IsWorkingDay||S.IsWorkingDay==="FALSE";});p.forEach(function(P){c.addSpecialDate(new D({startDate:a.convertToLocal(P.StartDate),type:sap.ui.unified.CalendarDayType.Type09,tooltip:P.IsPublicHoliday?P.PublicHolidayDescription:""}));});if(sap.ui.unified.CalendarDayType.NonWorking){n.forEach(function(N){c.addSpecialDate(new D({startDate:a.convertToLocal(N.StartDate),type:sap.ui.unified.CalendarDayType.NonWorking}));});}};return C;});
